@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@300;400;500;600&family=Outfit:wght@300;400;500;600;700&display=swap');

* { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

:root {
  --bg: #0c0c0c; --s: #111; --sh: #181818;
  --b: #1a1a1a; --bl: #252525;
  --t: #d4d4d4; --td: #666; --tm: #444;
  --fu: 'Outfit', -apple-system, sans-serif;
  --fm: 'IBM Plex Mono', 'SF Mono', monospace;
}

html, body, #root { height: 100%; overflow: hidden; }
body { background: var(--bg); color: var(--t); font-family: var(--fu); -webkit-font-smoothing: antialiased; }

::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: #252525; border-radius: 3px; }

.tp-root { width: 100%; height: 100vh; height: 100dvh; display: flex; flex-direction: column; background: var(--bg); overflow: hidden; }
.loading { height: 100vh; display: flex; align-items: center; justify-content: center; color: #444; font-family: var(--fm); background: var(--bg); }

/* ─── Update banner ─── */
.update-banner { display: flex; align-items: center; justify-content: space-between; padding: 8px 16px; background: #1a2332; border-bottom: 1px solid #38bdf833; flex-shrink: 0; gap: 12px; }
.update-banner span { font-size: 12px; font-family: var(--fm); color: #38bdf8; }
.update-actions { display: flex; align-items: center; gap: 8px; }
.update-dl { font-size: 11px; font-family: var(--fm); color: #38bdf8; border: 1px solid #38bdf844; padding: 3px 10px; border-radius: 6px; text-decoration: none; }
.update-dl:hover { background: #38bdf811; border-color: #38bdf8; }
.update-x { background: none; border: none; color: #555; font-size: 16px; cursor: pointer; padding: 0 4px; }
.update-x:hover { color: #999; }

/* ─── Header ─── */
.tp-hdr { display: flex; align-items: center; justify-content: space-between; padding: 14px 20px 10px; border-bottom: 1px solid var(--b); flex-shrink: 0; }
.tp-hdr-l { display: flex; align-items: center; gap: 10px; }
.tp-name { font-size: 16px; font-weight: 600; letter-spacing: -0.3px; color: #e8e8e8; }
.tp-ver { font-size: 10px; font-family: var(--fm); color: #333; font-weight: 400; }
.sync-dot { font-size: 12px; color: #4ecdc4; animation: spin 2s linear infinite; }
@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
.local-badge { font-size: 10px; font-family: var(--fm); color: var(--tm); border: 1px solid var(--bl); padding: 1px 6px; border-radius: 4px; }
.tp-sc-toggle { background: none; border: 1px solid var(--bl); color: var(--td); font-size: 16px; cursor: pointer; padding: 4px 8px; border-radius: 6px; }
.tp-sc-toggle:hover { border-color: #333; color: #888; }

/* ─── Invite bell ─── */
.invite-bell { background: none; border: 1px solid #fbbf2444; color: #fbbf24; font-size: 12px; padding: 2px 8px; border-radius: 999px; cursor: pointer; display: flex; align-items: center; gap: 4px; }
.invite-bell:hover { background: #fbbf2411; border-color: #fbbf24; }
.invite-count { font-family: var(--fm); font-size: 10px; font-weight: 600; }

/* ─── Nav ─── */
.tp-nav { border-bottom: 1px solid var(--b); flex-shrink: 0; }
.tp-nav-scroll { display: flex; align-items: center; overflow-x: auto; padding: 0 12px; scrollbar-width: none; }
.tp-nav-scroll::-webkit-scrollbar { display: none; }
.tp-t { background: none; border: none; border-bottom: 2px solid transparent; color: var(--td); font-family: var(--fu); font-size: 13px; font-weight: 500; padding: 10px 14px 8px; cursor: pointer; white-space: nowrap; display: flex; align-items: center; gap: 7px; transition: color .15s, border-color .15s; user-select: none; }
.tp-t:hover { color: #999; }
.tp-t-on { color: #e8e8e8 !important; }
.tp-td { width: 6px; height: 6px; border-radius: 50%; flex-shrink: 0; }
.tp-tc { font-size: 10px; font-weight: 600; color: #888; background: var(--b); padding: 1px 6px; border-radius: 8px; }
.tp-t-edit { color: #e8e8e8; background: #141414; outline: none; border-radius: 0; }
.tp-t-add { background: none; border: 1px dashed #2a2a2a; color: #555; font-size: 16px; cursor: pointer; padding: 3px 10px; border-radius: 6px; margin-left: 8px; font-family: var(--fm); line-height: 1; }
.tp-t-add:hover { border-color: #444; color: #888; }
.team-badge { font-size: 10px; filter: grayscale(1) brightness(2); }

/* ─── Context menu ─── */
.tp-ctx { position: fixed; background: #1a1a1a; border: 1px solid #2a2a2a; border-radius: 10px; padding: 6px; z-index: 1000; min-width: 240px; box-shadow: 0 8px 30px rgba(0,0,0,.5); max-height: 80vh; overflow-y: auto; }
.ctx-it { display: block; width: 100%; background: none; border: none; color: #ccc; font-family: var(--fu); font-size: 13px; padding: 8px 12px; cursor: pointer; text-align: left; border-radius: 6px; }
.ctx-it:hover { background: #252525; }
.ctx-it:disabled { opacity: 0.5; cursor: not-allowed; }
.ctx-del { color: #ff4444 !important; }
.ctx-cols { display: flex; gap: 5px; padding: 8px 12px; flex-wrap: wrap; }
.ctx-dot { width: 18px; height: 18px; border-radius: 50%; border: none; cursor: pointer; transition: transform .1s; }
.ctx-dot:hover { transform: scale(1.2); }
.ctx-kw { padding: 6px 12px; border-top: 1px solid #252525; margin-top: 4px; }
.ctx-kw-lbl { font-size: 11px; color: #555; font-family: var(--fm); display: block; margin-bottom: 6px; }
.ctx-kw-list { display: flex; flex-wrap: wrap; gap: 4px; margin-bottom: 6px; }
.kw-pill { font-size: 11px; font-family: var(--fm); color: #888; background: #1f1f1f; padding: 2px 8px; border-radius: 4px; display: flex; align-items: center; gap: 4px; }
.kw-pill button { background: none; border: none; color: #555; cursor: pointer; font-size: 13px; line-height: 1; padding: 0; }
.kw-pill button:hover { color: #ff4444; }
.kw-in { width: 100%; background: #141414; border: 1px solid #252525; border-radius: 4px; padding: 5px 8px; color: var(--t); font-family: var(--fm); font-size: 11px; outline: none; }
.kw-in::placeholder { color: #444; }

/* ─── Team section in context menu ─── */
.ctx-team-section { padding: 6px 0; border-top: 1px solid #252525; margin-top: 4px; }
.ctx-team-note { font-size: 10px; color: #555; font-family: var(--fm); padding: 2px 12px; }
.team-members { padding: 4px 12px; display: flex; flex-direction: column; gap: 6px; }
.team-member { display: flex; align-items: center; gap: 8px; }
.team-member-av { cursor: pointer; flex-shrink: 0; display: flex; align-items: center; }
.av-img { width: 24px; height: 30px; border: 2px solid; border-radius: 3px; image-rendering: pixelated; display: block; }
.av-empty { width: 24px; height: 30px; border: 2px dashed #444; border-radius: 3px; display: flex; align-items: center; justify-content: center; font-size: 10px; color: #555; font-family: var(--fm); }
.team-member-main { flex: 1; min-width: 0; }
.team-member-info { cursor: pointer; display: flex; flex-direction: column; gap: 1px; flex: 1; padding: 3px 0; }
.team-member-info:hover .team-nick { color: #bbb; }
.team-nick { font-size: 12px; font-family: var(--fm); color: #888; }
.team-email { font-size: 9px; font-family: var(--fm); color: #444; }
.team-invite { padding: 6px 12px; }

/* ─── Avatar picker ─── */
.av-picker { display: flex; flex-wrap: wrap; gap: 4px; margin-top: 4px; padding: 4px; background: #111; border: 1px solid #252525; border-radius: 6px; }
.av-opt { background: #181818; border: 2px solid transparent; border-radius: 4px; cursor: pointer; padding: 2px; display: flex; align-items: center; justify-content: center; transition: border-color .15s, background .15s; }
.av-opt:hover { background: #222; }
.av-opt-on { background: #1a1a2e; }
.av-opt img { image-rendering: pixelated; display: block; }

/* ─── Body ─── */
.tp-body { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
.tp-prog { display: flex; align-items: center; gap: 10px; padding: 12px 20px 6px; flex-shrink: 0; }
.tp-pbar { flex: 1; height: 3px; background: var(--b); border-radius: 2px; overflow: hidden; }
.tp-pfill { height: 100%; border-radius: 2px; transition: width .3s; }
.tp-pnum { font-size: 11px; color: #555; font-family: var(--fm); font-weight: 500; }
.tp-pcl { background: none; border: 1px solid var(--bl); color: var(--td); font-family: var(--fu); font-size: 11px; cursor: pointer; padding: 3px 10px; border-radius: 6px; }
.tp-pcl:hover { border-color: #444; color: #999; }

.tp-tasks { flex: 1; overflow-y: auto; padding: 4px 16px 16px; scrollbar-width: thin; scrollbar-color: #252525 transparent; }
.tp-tasks::-webkit-scrollbar { width: 6px; }
.tp-tasks::-webkit-scrollbar-track { background: transparent; }
.tp-tasks::-webkit-scrollbar-thumb { background: #252525; border-radius: 3px; }
.tp-empty { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; color: var(--tm); font-size: 13px; font-family: var(--fm); gap: 8px; cursor: pointer; }
.tp-empty:hover { color: #555; }

/* ─── Tasks ─── */
.task-row { display: flex; align-items: flex-start; gap: 8px; padding: 8px 10px; border-left: 2px solid; border-radius: 0 6px 6px 0; background: var(--s); user-select: none; will-change: transform; }
.task-row:hover { background: var(--sh); }
.task-row:hover .task-actions .del-btn { color: #444; }
.task-row:hover .task-actions .hide-btn { color: #444; }
.task-done { opacity: .45; transition: opacity .15s; }
.task-done:hover { opacity: .75; }

.drag-grip { color: #333; font-size: 12px; cursor: grab; padding: 2px 4px; border-radius: 4px; line-height: 1; letter-spacing: -2px; user-select: none; flex-shrink: 0; touch-action: none; }
.drag-grip:hover { color: #666; background: #1a1a1a; }
.drag-grip:active { cursor: grabbing; }

.checkbox { background: none; border: none; cursor: pointer; padding: 0; flex-shrink: 0; }
.cb-inner { width: 18px; height: 18px; border-radius: 4px; border: 2px solid; display: flex; align-items: center; justify-content: center; transition: all .15s; }
.chk { font-size: 11px; color: #000; font-weight: 700; }
.task-body { flex: 1; display: flex; flex-direction: column; gap: 4px; min-height: 24px; cursor: text; padding-top: 1px; }
.task-text { font-size: 13px; font-family: var(--fm); font-weight: 400; line-height: 1.4; word-break: break-word; color: var(--t); }
.task-done .task-text { text-decoration: line-through; color: #777; }
.task-badges { display: flex; gap: 6px; justify-content: flex-end; flex-wrap: wrap; }
.task-input { flex: 1; min-width: 100px; width: 100%; background: transparent; border: none; border-bottom: 1px solid #333; padding: 2px 0; color: var(--t); font-family: var(--fm); font-size: 13px; outline: none; resize: none; overflow: hidden; line-height: 1.4; }
.task-tag { font-size: 10px; font-family: var(--fm); font-weight: 500; border: 1px solid; padding: 1px 7px; border-radius: 4px; white-space: nowrap; }

/* Author tag with avatar color */
.task-author { font-size: 9px; font-family: var(--fm); font-weight: 500; color: #555; background: #1a1a1a; padding: 2px 6px; border-radius: 3px; white-space: nowrap; display: inline-flex; align-items: center; gap: 3px; border: 1px solid transparent; line-height: 1; }
.task-author-av { width: 10px; height: 12px; image-rendering: pixelated; flex-shrink: 0; vertical-align: middle; }

/* ─── Task action buttons (vertically centered) ─── */
.task-actions { display: flex; align-items: center; gap: 2px; flex-shrink: 0; align-self: center; }

.hide-btn { background: none; border: none; color: transparent; cursor: pointer; padding: 4px; line-height: 0; border-radius: 4px; transition: color .15s; display: flex; align-items: center; justify-content: center; }
.hide-btn:hover { color: #888 !important; }
.hide-btn svg { display: block; }

.del-btn { background: none; border: none; color: transparent; cursor: pointer; padding: 4px; line-height: 0; border-radius: 4px; transition: color .15s; display: flex; align-items: center; justify-content: center; }
.del-btn:hover { color: #ff4444 !important; }
.del-btn svg { display: block; }

/* ─── Insert zone ─── */
.ins-zone { height: 10px; position: relative; cursor: pointer; display: flex; align-items: center; padding: 0 12px; }
.ins-line { position: absolute; left: 12px; right: 12px; height: 2px; border-radius: 1px; transition: opacity .15s; display: flex; align-items: center; justify-content: center; }
.ins-plus { font-size: 11px; font-weight: 700; background: var(--bg); padding: 0 4px; border: 1px solid; border-radius: 3px; line-height: 1.2; font-family: var(--fm); }

/* ─── Shortcuts bar ─── */
.sc-bar { border-top: 1px solid var(--b); padding: 10px 16px; flex-shrink: 0; background: #0a0a0a; overflow: hidden; }
.sc-row { display: flex; gap: 8px; overflow-x: auto; align-items: center; padding: 2px 0 4px; -webkit-overflow-scrolling: touch; scrollbar-width: thin; scrollbar-color: #252525 transparent; }
.sc-row::-webkit-scrollbar { height: 3px; }
.sc-row::-webkit-scrollbar-track { background: transparent; }
.sc-row::-webkit-scrollbar-thumb { background: #333; border-radius: 2px; }
.sc-row::-webkit-scrollbar-thumb:hover { background: #555; }
.sc-wrap { flex-shrink: 0; position: relative; width: 36px; height: 36px; will-change: transform; touch-action: none; }
.sc-icon { width: 36px; height: 36px; border-radius: 10px; background: var(--s); border: 1px solid var(--bl); display: flex; align-items: center; justify-content: center; text-decoration: none; transition: border-color .15s, background .15s; }
.sc-icon:hover { background: #1a1a1a; border-color: #333; }
.sc-icon img { border-radius: 3px; pointer-events: none; }
.sc-fb { font-size: 14px; font-weight: 700; font-family: var(--fm); }

.sc-add { flex-shrink: 0; width: 36px; height: 36px; border-radius: 10px; background: var(--s); border: 1px dashed #2a2a2a; color: #555; font-family: var(--fm); font-size: 16px; cursor: pointer; display: flex; align-items: center; justify-content: center; line-height: 1; }
.sc-add:hover { border-color: #444; color: #aaa; background: #101010; }

/* ─── Shortcuts modal ─── */
.sc-list { border: 1px solid #222; border-radius: 12px; background: #0b0b0b; padding: 8px; display: flex; flex-direction: column; gap: 6px; max-height: 220px; overflow: auto; }
.sc-li { display: flex; align-items: center; justify-content: space-between; gap: 10px; padding: 6px 8px; border-radius: 10px; cursor: pointer; }
.sc-li:hover { background: #101010; }
.sc-li-l { display: flex; align-items: center; gap: 10px; min-width: 0; }
.sc-li-l img { border-radius: 3px; }
.sc-li-name { font-family: var(--fm); font-size: 12px; color: #bbb; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.sc-li-r { display: flex; gap: 6px; flex-shrink: 0; }
.sc-li-btn { background: #101010; border: 1px solid #222; color: #777; border-radius: 10px; padding: 6px 8px; cursor: pointer; font-family: var(--fm); font-size: 11px; }
.sc-li-btn:hover { border-color: #333; color: #bbb; }
.sc-li-del { color: #ff6b6b; }

.sc-form { border-top: 1px solid #1a1a1a; padding-top: 10px; display: flex; flex-direction: column; gap: 10px; }
.sc-form-h { font-family: var(--fm); font-size: 11px; color: #666; }

/* ─── Invite rows ─── */
.invite-row { display: flex; align-items: center; justify-content: space-between; gap: 10px; padding: 8px; border: 1px solid #222; border-radius: 8px; }
.invite-info { display: flex; flex-direction: column; gap: 2px; }
.invite-from { font-size: 12px; font-family: var(--fm); color: #bbb; }
.invite-proj { font-size: 10px; font-family: var(--fm); color: #555; }
.invite-actions { display: flex; gap: 6px; }
.invite-accept { background: #1a2a1a; border: 1px solid #34d39944; color: #34d399; font-family: var(--fm); font-size: 11px; padding: 4px 10px; border-radius: 6px; cursor: pointer; }
.invite-accept:hover { background: #1a3a1a; border-color: #34d399; }
.invite-accept:disabled { opacity: 0.5; cursor: not-allowed; }
.invite-decline { background: none; border: 1px solid #333; color: #666; font-family: var(--fm); font-size: 11px; padding: 4px 10px; border-radius: 6px; cursor: pointer; }
.invite-decline:hover { border-color: #555; color: #999; }

/* ─── Footer ─── */
.tp-foot { padding: 6px 16px 8px; font-size: 10px; color: #222; font-family: var(--fm); text-align: center; flex-shrink: 0; }

/* ─── Sync / Auth ─── */
.tp-auth-btn { background: transparent; border: 1px solid var(--bl); color: #666; font-size: 11px; padding: 2px 8px; border-radius: 999px; cursor: pointer; line-height: 1.6; }
.tp-auth-btn:hover { border-color: #333; color: #aaa; background: #101010; }

.tp-modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.6); display: flex; align-items: center; justify-content: center; z-index: 9999; padding: 16px; }
.tp-modal { width: min(420px, 100%); border: 1px solid #222; background: #0d0d0d; border-radius: 14px; box-shadow: 0 12px 48px rgba(0,0,0,0.6); overflow: hidden; }
.tp-modal-h { display: flex; align-items: center; justify-content: space-between; padding: 12px 14px; border-bottom: 1px solid #1a1a1a; }
.tp-modal-title { font-family: var(--fm); font-size: 12px; color: #bbb; letter-spacing: 0.2px; }
.tp-modal-x { background: none; border: none; color: #444; font-size: 20px; cursor: pointer; line-height: 1; padding: 0 4px; }
.tp-modal-x:hover { color: #777; }
.tp-modal-body { padding: 14px; display: flex; flex-direction: column; gap: 10px; }
.tp-modal-tabs { display: flex; gap: 8px; }
.tp-modal-tab { flex: 1; background: #101010; border: 1px solid #222; color: #777; border-radius: 10px; padding: 8px 10px; cursor: pointer; font-family: var(--fm); font-size: 12px; }
.tp-modal-tab.on { border-color: #333; color: #bbb; background: #0f0f0f; }
.tp-modal-in { width: 100%; background: #0b0b0b; border: 1px solid #222; border-radius: 10px; padding: 10px 12px; color: var(--t); outline: none; font-family: var(--fm); font-size: 13px; }
.tp-modal-in:focus { border-color: #333; }
.tp-modal-btn { width: 100%; background: #141414; border: 1px solid #2a2a2a; color: #bbb; border-radius: 10px; padding: 10px 12px; cursor: pointer; font-family: var(--fm); font-size: 13px; }
.tp-modal-btn:hover { background: #181818; border-color: #3a3a3a; }
.tp-modal-btn:disabled { opacity: 0.55; cursor: not-allowed; }
.tp-modal-note { font-size: 11px; color: #666; font-family: var(--fm); line-height: 1.4; }
.tp-modal-err { font-size: 11px; color: #ff6b6b; font-family: var(--fm); }

@media (max-width: 600px) {
  .tp-hdr { padding: 12px 16px 8px; }
  .tp-tasks { padding: 4px 12px 12px; }
  .task-row { padding: 7px 8px; gap: 6px; }
  .task-text { font-size: 12px; }
  .sc-bar { padding: 8px 12px; }
  .sc-row { scrollbar-width: none; }
  .sc-row::-webkit-scrollbar { display: none; }
  .sc-wrap { width: 32px; height: 32px; }
  .sc-icon { width: 32px; height: 32px; border-radius: 8px; }
  .sc-icon img { width: 16px; height: 16px; }
  .tp-foot { font-size: 9px; }
  .tp-hdr { padding-top: max(12px, env(safe-area-inset-top)); }
  .tp-foot { padding-bottom: max(6px, env(safe-area-inset-bottom)); }
}

@media (display-mode: standalone) {
  .tp-hdr { padding-top: max(14px, env(safe-area-inset-top)); }
}
